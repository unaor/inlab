<!DOCTYPE html>
<html lang="en">
<hgroup th:insert="fragments/cliente/headCliente.html :: headCliente"> </hgroup>

<body class="sidebar-mini">
<style>
[data-tooltip] {
  position: relative;
  z-index: 9999999;
  cursor: pointer;
}

/* Hide the tooltip content by default */
[data-tooltip]:before,
[data-tooltip]:after {
  visibility: hidden;
  -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
  filter: progid: DXImageTransform.Microsoft.Alpha(Opacity=0);
  opacity: 0;
  pointer-events: none;
}

/* Position tooltip above the element */
[data-tooltip]:before {
  position: absolute;
  bottom: 80%;
  left: 50%;
  margin-bottom: 5px;
  margin-left: -30px;
  padding: 7px;
  width: 200px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #000;
  background-color: hsla(0, 0%, 20%, 1);
  color: #fff;
  content: attr(data-tooltip);
  text-align: center;
  font-size: 14px;
  line-height: 1.2;
}

/* Triangle hack to make tooltip look like a speech bubble */
[data-tooltip]:after {
  position: absolute;
  bottom: 80%;
  left: 50%;
  margin-left: 1px;
  width: 0;
  border-top: 5px solid #000;
  border-top: 5px solid hsla(0, 0%, 20%, 0.9);
  border-right: 5px solid transparent;
  border-left: 5px solid transparent;
  content: " ";
  font-size: 0;
  line-height: 0;
}

/* Show tooltip content on hover */
[data-tooltip]:hover:before,
[data-tooltip]:hover:after {
  visibility: visible;
  -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
  filter: progid: DXImageTransform.Microsoft.Alpha(Opacity=100);
  opacity: 1;
  z-index: 9999999;
}
</style>


<div class="wrapper">
<!--NAV-->
<!-- SIDEBAR    -->
<aside th:insert="fragments/cliente/asideCliente.html :: asideCliente"> </aside>
<!-- /SIDEBAR    -->
<!-- TOPBAR    -->
<!--/NAV-->
    <!--MAIN-->
    <div class="main-panel">
       <!-- HEADER -->
       <nav th:insert="fragments/nav.html :: nav"> </nav>
        <!-- /HEADER -->
            
<!-- /TOPBAR    -->
<!-- CONTENT    -->            
            
            <!--CONTAINER-->
            <div class="panel-header panel-header-sm">
            </div>
            <div class="content">
				<div class="row">
					<input id="hiddenInsightId" type="hidden" th:field="${campaign.insightId}" />
				    <div class="col-sm-10 col-centered">
				        <div class="card ">
				            <div class="card-header ">
				                <h5 class="card-title"><i class="now-ui-icons business_bulb-63"></i> INSIGHT</h5>
				            </div>
				            <div class="card-body pb-md-5 text-center">
				                <!--iframe-->
				                <div id="cloudContainer" class="col-centered container-fluid full jqcloud" style="overflow:hidden;"></div>
				                <!--/iframe-->
				            </div>
				        </div>
				    </div>
				</div>
            </div>
            <!--/CONTAINER-->
            
<!-- /CONTENT   -->



<!--FOOTER-->
<footer th:insert="fragments/footer.html :: footer"> </footer>
<!--/FOOTER-->


        </div>
        <!--/MAIN-->
    </div>
<!-- /BODY -->

<var th:insert="fragments/scripts.html :: var"> </var>

<!--<script src="/Plugins/jQCloud-master/jqcloud-1.0.4.js"></script>
<script src="/Plugins/jquery-tagcloud-master/jquery.tagcloud.js"></script> -->



<script th:inline="javascript">
/*<![CDATA[*/

    var answers = /*[[${answers}]]*/ 'default';
   
    console.log(answers);
   
    answers.map((answer, index) => {
        $("#cloudContainer").append('<h4 class="alert alert-primary text-white text-uppercase" style="border:0;" role="alert">' + answer.questionName + '</h4><br><div class="col-md-10 col-centered justify-content-center jqcloud" id="question-' + index + '"></div>')
         /* $("#question-" + index).append("<h2>" + answer.questionName + "</h2>"); */
         answer.tags.map(tag => tag.html = {'data-tooltip': tag.text + ' - ' + tag.weight});
        //$("#question-" + index).jQCloud(answer.tags, {width:800, height:600, autoResize:true});
        
        
        var text_string = answers[index].tags[index].wholeWords;

    	drawWordCloud(text_string);

    	function drawWordCloud(text_string){
    	  var common = answers[0].tags[0].badWords;
    	
    	  var word_count = {};
    	
    	  var words = text_string.split(/[ '\-\(\)\*":;\[\]|{},.!?]+/);
    	    if (words.length == 1){
    	      word_count[words[0]] = 1;
    	    } else {
    	      words.forEach(function(word){
    	        var word = word.toLowerCase();
    	        if (word != "" && common.indexOf(word)==-1 && word.length>1){
    	          if (word_count[word]){
    	            word_count[word]++;
    	          } else {
    	            word_count[word] = 1;
    	          }
    	        }
    	      })
    	    }
    	
    	  var svg_location = "#question-" + index;
    	  var width = ($(document).width())/2;
    	  var height = ($(document).height())/2;
    	
    	  var fill = d3.scale.category20();
    	
    	  var word_entries = d3.entries(word_count);
    	
    	  var xScale = d3.scale.linear()
    	     .domain([0, d3.max(word_entries, function(d) {
    	        return d.value;
    	      })
    	     ])
    	     .range([10,100]);
    	
    	  d3.layout.cloud().size([width, height])
    	    .timeInterval(20)
    	    .words(word_entries)
    	    .fontSize(function(d) { return xScale(+d.value); })
    	    .text(function(d) { return d.key; })
    	    .rotate(function() { return ~~(Math.random() * 2) * 90; })
    	    .font("Impact")
    	    .on("end", draw)
    	    .start();
    	
    	  function draw(words) {
    	    d3.select(svg_location).append("svg")
    	        .attr("width", width)
    	        .attr("height", height)
    	      .append("g")
    	        .attr("transform", "translate(" + [width >> 1, height >> 1] + ")")
    	      .selectAll("text")
    	        .data(words)
    	      .enter().append("text")
    	        .style("font-size", function(d) { return xScale(d.value) + "px"; })
    	        .style("font-family", "Impact")
    	        .style("fill", function(d, i) { return fill(i); })
    	        .attr("text-anchor", "middle")
    	        .attr("transform", function(d) {
    	          return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
    	        })
    	        .text(function(d) { return d.key; });
    	  }
    	
    	  //d3.layout.cloud().stop();
    	}
       
    });
/*]]>*/
</script>






</body>
</html>